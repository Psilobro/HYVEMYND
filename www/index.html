<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>HYVEMYND</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  
  <!-- App Icons and Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon-16.png">
  <link rel="apple-touch-icon" href="assets/images/logo.png">
  <meta name="msapplication-TileImage" content="assets/images/logo.png">
  <meta name="msapplication-TileColor" content="#ffd700">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffd700">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Background video - loads first with high priority -->
  <video autoplay muted loop playsinline preload="metadata" webkit-playsinline="true" id="bg-video" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -10;">
    <source src="assets/videos/honeycells.mp4" type="video/mp4">
    <source src="assets/videos/honeycells.webm" type="video/webm">
  </video>
  
  <!-- Hidden video fallback background -->
  <div id="video-fallback" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(45deg, #1a1a1a, #2d2d2d); z-index: -11; display: none;"></div>
  
  <!-- Force video loading priority -->
  <script>
    // Ensure background video loads first on mobile
    (function() {
      const video = document.getElementById('bg-video');
      const fallback = document.getElementById('video-fallback');
      
      if (video) {
        // Force video to load immediately
        video.load();
        
        // Handle mobile autoplay restrictions
        const playVideo = () => {
          video.play().catch(e => {
            console.log('Video autoplay blocked, trying muted play:', e);
            video.muted = true;
            video.play().catch(e2 => {
              console.log('Video play failed, showing fallback:', e2);
              if (fallback) fallback.style.display = 'block';
            });
          });
        };
        
        // Try to play immediately
        playVideo();
        
        // Also try on user interaction
        document.addEventListener('touchstart', playVideo, { once: true });
        document.addEventListener('click', playVideo, { once: true });
        
        // Show fallback on error
        video.addEventListener('error', (e) => {
          console.error('üé• Video error, showing fallback:', e);
          if (fallback) fallback.style.display = 'block';
        });
        
        // Hide fallback when video plays
        video.addEventListener('playing', () => {
          console.log('üé• Video is playing');
          if (fallback) fallback.style.display = 'none';
        });
        
        // Debug logging
        video.addEventListener('loadstart', () => console.log('üé• Video loading started'));
        video.addEventListener('canplay', () => console.log('üé• Video can play'));
      }
    })();
  </script>
  
  <div id="game-title" style="font-family: 'Milonga', serif;">HYVEMYND</div>
  <div id="hud">
    <div id="turn-display">White to move</div>
    <div id="hud-controls">
      <button id="reset-button">Reset Game</button>
      <button id="pause-game-button">‚è∏Ô∏è Pause</button>
    </div>
  </div>
  <div id="move-history">
    <button id="history-close-btn" style="position: absolute; top: -8px; right: -8px; width: 24px; height: 24px; background: #E6B84D; border: 2px solid #4B382A; color: #4B382A; font-size: 14px; cursor: pointer; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.3); z-index: 31;" title="Close History">‚ñº</button>
    <div id="history-content" style="height: 100%; overflow-y: auto; overflow-x: hidden;">
      <div id="history-header" style="padding: 8px 10px 4px 10px; border-bottom: 1px solid rgba(230,184,77,0.2);">
        <h3 style="margin: 0; font-size: 14px; font-family: 'Milonga', serif; color: var(--text);">Move History</h3>
      </div>
      <ol id="moves-list"></ol>
    </div>
    <div id="history-controls" style="position:sticky;bottom:0;z-index:10;background:rgba(0,0,0,0.5);padding-top:4px;">
      <input type="range" id="history-slider" min="0" value="0" step="1" style="width: 100%; margin: 8px 0;">
      <button id="return-to-live" style="display:none; margin: 4px 0;">Return to Live</button>
    </div>
  </div>
  <div id="game-container">
    <div id="app"></div>
  </div>
  
  <!-- Engine Progress Popup -->
  <div id="engine-progress-popup">
    <div class="crt-monitor">
      <div class="power-led"></div>
      <div class="crt-screen">
        <div class="progress-title">ü§ñ Engine Thinking...</div>
        <div class="progress-details">
          <span class="progress-label">Time:</span>
          <span class="progress-value" id="progress-time">0s</span>
        </div>
        <div class="progress-details">
          <span class="progress-label">Depth:</span>
          <span class="progress-value" id="progress-depth">-</span>
        </div>
        <div class="progress-details">
          <span class="progress-label">‚è±Ô∏è Stopwatch:</span>
          <span class="progress-value" id="progress-stopwatch">0.0s</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar" id="progress-bar"></div>
        </div>
        <div class="engine-status" id="engine-status">Analyzing position...</div>
        <div class="engine-output" id="engine-output"><code></code></div>
      </div>
    </div>
  </div>
  
  <!-- Dual AI Thinking Consoles (AI vs AI battles) -->
  <div id="white-ai-console" class="ai-console" style="display:none;">
    <div class="console-header">‚ö™ White AI</div>
    <div class="console-output" id="white-ai-output"></div>
  </div>
  <div id="black-ai-console" class="ai-console" style="display:none;">
    <div class="console-header">‚ö´ Black AI</div>
    <div class="console-output" id="black-ai-output"></div>
  </div>
  
  <div id="white-tray" class="player-tray"></div>
  <div id="black-tray" class="player-tray"></div>
  <button id="play-music-button">üéµ Play Music</button>
  <button id="auto-zoom-toggle">üéØ Auto-Center: ON</button>
  <button id="move-history-toggle">History</button>
  
  <!-- Settings Menu -->
  <div id="settings-menu-container">
    <div id="settings-menu" class="settings-menu-hidden">
      <button class="settings-menu-item" data-action="single-mode">ü§ñ Single Mode</button>
      <button class="settings-menu-item" data-action="multiplayer">üåê Multiplayer</button>
      <button class="settings-menu-item" data-action="dev-ops">‚öôÔ∏è Dev Ops</button>
      <button class="settings-menu-item" data-action="tray-ops">üìê Tray Ops</button>
    </div>
    <button id="settings-button">‚öôÔ∏è Settings</button>
  </div>
  
  <button id="chat-toggle" style="display: none;">üí¨ Chat</button>
  <audio id="background-music" src="assets/sounds/cosmic-ambient.mp3" loop></audio>
  
  <!-- Chat Container -->
  <div id="chat-container" style="display: none;">
    <div id="chat-header">
      <span>üí¨ Game Chat</span>
      <button id="chat-close">√ó</button>
    </div>
    <div id="chat-messages"></div>
    <div id="chat-input-container">
      <input type="text" id="chat-input" placeholder="Type a message..." maxlength="200">
      <button id="chat-send">Send</button>
    </div>
    <div id="typing-indicator"></div>
  </div>

  <!-- Dev. Ops Modal -->
  <div id="dev-ops-modal" style="display: none;">
    <div id="dev-ops-header">
      <span>‚öôÔ∏è Development Operations</span>
      <button id="dev-ops-close">√ó</button>
    </div>
    <div id="dev-ops-content">
      <div id="dev-ops-tabs">
        <button class="dev-ops-tab active" data-tab="ai-vs-ai">ü§ñ AI vs AI</button>
        <button class="dev-ops-tab" data-tab="human-learning">üß† Human Learning</button>
        <button class="dev-ops-tab" data-tab="engine">üîß Engine</button>
        <button class="dev-ops-tab" data-tab="personalities">üé≠ Personalities</button>
        <button class="dev-ops-tab" data-tab="statistics">üìä Statistics</button>
      </div>
      
      <!-- AI vs AI Panel -->
      <div id="ai-vs-ai-panel" class="dev-ops-panel active">
        <h3>AI Battle Arena</h3>
        <div class="ai-battle-setup">
          <div class="player-selection">
            <label>White AI:</label>
            <select id="white-ai-select">
              <option value="sunny">Sunny (Depth 3)</option>
              <option value="buzzwell">Buzzwell (Depth 4)</option>
              <option value="beedric">Beedric (Depth 6)</option>
            </select>
          </div>
          <div class="player-selection">
            <label>Black AI:</label>
            <select id="black-ai-select">
              <option value="buzzwell" selected>Buzzwell (Depth 4)</option>
              <option value="sunny">Sunny (Depth 3)</option>
              <option value="beedric">Beedric (Depth 6)</option>
            </select>
          </div>
          <div class="battle-controls">
            <button id="start-ai-battle">üöÄ Start Battle</button>
            <button id="stop-ai-battle" style="display: none;">‚èπÔ∏è Stop Battle</button>
          </div>
        </div>
        <div id="battle-status" class="battle-status">Ready to start AI battle</div>
      </div>
      
      <!-- Human Learning Panel -->
      <div id="human-learning-panel" class="dev-ops-panel">
        <h3>Human Learning Mode</h3>
        <div class="learning-setup">
          <p>Train AI by playing against it. Your moves and strategies will be analyzed to improve AI performance.</p>
          <div class="learning-controls">
            <button id="start-learning-game">üéì Start Learning Game</button>
            <div class="learning-opponent">
              <label>Opponent:</label>
              <select id="learning-opponent-select">
                <option value="beedric" selected>Beedric V2 (Learning)</option>
              </select>
            </div>
          </div>
        </div>
        <div id="learning-status" class="learning-status">Ready to start learning session</div>
      </div>
      
      <!-- Engine Panel -->
      <div id="engine-panel" class="dev-ops-panel">
        <h3>üîß Engine Controller</h3>
        
        <div class="engine-status-section">
          <div class="engine-status-header">
            <h4>Connection Status</h4>
            <div id="engine-connection-status" class="connection-status">
              <span id="connection-indicator" class="status-dot disconnected"></span>
              <span id="connection-text">WASM Engine Ready - UHP Protocol Active</span>
            </div>
          </div>
          
          <div id="engine-thinking-indicator" class="thinking-indicator" style="display: none;">
            <span class="thinking-dots">üß† Engine thinking</span>
          </div>
        </div>

        <div class="engine-controls-section">
          <h4>Engine Selection</h4>
          <div class="engine-selection">
            <div class="control-group">
              <label for="engine-select">Active Engine:</label>
              <select id="engine-select">
                <option value="nokamute">Nokamute (Tournament)</option>
                <option value="mzinga">Mzinga Engine</option>
                <option value="custom">Custom Engine</option>
              </select>
              <button id="restart-engine" class="engine-action">üîÑ Restart</button>
            </div>
            
            <div id="custom-engine-config" class="control-group" style="display: none;">
              <label for="custom-engine-path">Custom Engine Path:</label>
              <input type="text" id="custom-engine-path" placeholder="C:\path\to\your\engine.exe">
              <button id="add-custom-engine" class="engine-action">‚ûï Add Engine</button>
            </div>
          </div>
        </div>

        <div class="engine-settings-section">
          <h4>Engine Parameters</h4>
          <div class="settings-grid">
            <div class="control-group">
                            <label class="switch">
                <input type="checkbox" id="engine-enabled" checked disabled> WASM Engine (Always On)
              </label>
              <small>Use external engine for AI moves</small>
            </div>
            
            <div class="control-group">
              <label for="engine-mode">Mode:</label>
              <select id="engine-mode">
                <option value="time">Time Limited</option>
                <option value="depth">Depth Limited</option>
              </select>
            </div>
            
            <div class="control-group">
              <label for="time-limit">Time Limit:</label>
              <div class="slider-container">
                <input type="range" id="time-limit" min="1" max="30" value="5" step="1">
                <span id="time-value">5s</span>
              </div>
            </div>
            
            <div class="control-group">
              <label for="depth-limit">Search Depth:</label>
              <div class="slider-container">
                <input type="range" id="depth-limit" min="1" max="10" value="4" step="1">
                <span id="depth-value">4 ply</span>
              </div>
            </div>
            
            <div class="control-group">
              <label for="table-size">Transposition Table:</label>
              <div class="slider-container">
                <input type="range" id="table-size" min="100" max="2000" value="100" step="50">
                <span id="table-size-value">100MB</span>
              </div>
              <small style="color: #999; font-size: 11px; margin-top: 4px; display: block;">‚ö†Ô∏è Changes require engine restart</small>
            </div>
            
            <div class="control-group">
              <label for="engine-color">Engine Plays:</label>
              <select id="engine-color">
                <option value="black">Black (Default AI)</option>
                <option value="white">White (Human opponent)</option>
                <option value="both">Both (Engine vs Engine)</option>
              </select>
            </div>
          </div>
        </div>

        <div class="engine-settings-section">
          <h4>üéÆ Quick Start</h4>
          <div class="settings-grid">
            <div class="control-group">
              <button id="start-engine-game" class="engine-action start-game-btn">
                üöÄ Start Game Now
              </button>
              <small>New game with current engine settings</small>
            </div>
          </div>
        </div>

        <div class="engine-log-section">
          <h4>Engine Communication</h4>
          <div id="engine-log" class="engine-log">
            <div class="log-entry">üîó Starting UHP client...</div>
          </div>
          <div class="log-controls">
            <button id="clear-log" class="engine-action">üóëÔ∏è Clear Log</button>
            <button id="test-engine" class="engine-action">üß™ Test Engine</button>
          </div>
        </div>

        <div class="engine-info-section">
          <h4>About WASM Engine</h4>
          <p>HYVEMYND includes a built-in Nokamute engine via WebAssembly for offline tournament-strength play. No external setup required!</p>
          <div class="engine-commands">
            <strong>Quick Start:</strong>
            <ol>
              <li>‚úÖ WASM engine loads automatically on first use</li>
              <li>üéÆ Use Single Mode or AI vs AI battles</li>
              <li>‚öôÔ∏è Adjust personalities for different difficulty levels</li>
            </ol>
            <p><strong>Features:</strong> Configurable transposition table (100MB-2GB), adjustable search depth, personality-based difficulty scaling</p>
          </div>
        </div>
      </div>
      
      <!-- Personalities Panel -->
      <div id="personalities-panel" class="dev-ops-panel">
        <h3>üé≠ AI Personality Configuration</h3>
        <div class="personalities-intro">
          <p>Adjust the strength and character of each AI personality used in Single Mode. These settings affect how the Nokamute engine behaves for each difficulty level.</p>
        </div>
        
        <!-- Sunny Pollenpatch (Easy) -->
        <div class="personality-config">
          <div class="personality-header">
            <span class="personality-icon">üåª</span>
            <div class="personality-info">
              <h4>Sunny Pollenpatch</h4>
              <span class="personality-subtitle">The Cheerful Forager ‚Ä¢ Easy Difficulty</span>
            </div>
          </div>
          <div class="personality-controls">
            <div class="control-group">
              <label for="sunny-time-limit">Time Limit (seconds):</label>
              <input type="range" id="sunny-time-limit" min="1" max="5" value="2" class="personality-slider">
              <span id="sunny-time-value" class="control-value">2s</span>
            </div>
            <div class="control-group">
              <label for="sunny-depth-limit">Search Depth (ply):</label>
              <input type="range" id="sunny-depth-limit" min="2" max="6" value="3" class="personality-slider">
              <span id="sunny-depth-value" class="control-value">3 ply</span>
            </div>
            <div class="control-group">
              <label for="sunny-aggression">Aggression (1=Defensive, 5=Reckless):</label>
              <input type="range" id="sunny-aggression" min="1" max="5" value="2" class="personality-slider">
              <span id="sunny-aggression-value" class="control-value">2 (Cautious)</span>
            </div>
            <div class="control-group">
              <label for="sunny-hash">Hash Size (MB):</label>
              <select id="sunny-hash" class="personality-select">
                <option value="16">16 MB</option>
                <option value="32" selected>32 MB</option>
                <option value="64">64 MB</option>
                <option value="128">128 MB</option>
                <option value="256">256 MB</option>
              </select>
            </div>
            <div class="control-group">
              <label for="sunny-mode">Search Mode:</label>
              <select id="sunny-mode" class="personality-select">
                <option value="time" selected>Time-based</option>
                <option value="depth">Depth-based</option>
              </select>
            </div>
            <div class="control-group checkbox-group">
              <input type="checkbox" id="sunny-random-opening">
              <label for="sunny-random-opening">Random Opening Moves</label>
            </div>
          </div>
        </div>
        
        <!-- Buzzwell Stingmore (Medium) -->
        <div class="personality-config">
          <div class="personality-header">
            <span class="personality-icon">‚öîÔ∏è</span>
            <div class="personality-info">
              <h4>Buzzwell Stingmore</h4>
              <span class="personality-subtitle">The Disciplined Guard ‚Ä¢ Medium Difficulty</span>
            </div>
          </div>
          <div class="personality-controls">
            <div class="control-group">
              <label for="buzzwell-time-limit">Time Limit (seconds):</label>
              <input type="range" id="buzzwell-time-limit" min="2" max="8" value="4" class="personality-slider">
              <span id="buzzwell-time-value" class="control-value">4s</span>
            </div>
            <div class="control-group">
              <label for="buzzwell-depth-limit">Search Depth (ply):</label>
              <input type="range" id="buzzwell-depth-limit" min="3" max="8" value="5" class="personality-slider">
              <span id="buzzwell-depth-value" class="control-value">5 ply</span>
            </div>
            <div class="control-group">
              <label for="buzzwell-aggression">Aggression (1=Defensive, 5=Reckless):</label>
              <input type="range" id="buzzwell-aggression" min="1" max="5" value="3" class="personality-slider">
              <span id="buzzwell-aggression-value" class="control-value">3 (Balanced)</span>
            </div>
            <div class="control-group">
              <label for="buzzwell-hash">Hash Size (MB):</label>
              <select id="buzzwell-hash" class="personality-select">
                <option value="16">16 MB</option>
                <option value="32">32 MB</option>
                <option value="64" selected>64 MB</option>
                <option value="128">128 MB</option>
                <option value="256">256 MB</option>
              </select>
            </div>
            <div class="control-group">
              <label for="buzzwell-mode">Search Mode:</label>
              <select id="buzzwell-mode" class="personality-select">
                <option value="time" selected>Time-based</option>
                <option value="depth">Depth-based</option>
              </select>
            </div>
            <div class="control-group checkbox-group">
              <input type="checkbox" id="buzzwell-random-opening">
              <label for="buzzwell-random-opening">Random Opening Moves</label>
            </div>
          </div>
        </div>
        
        <!-- Beedric Bumbleton (Hard) -->
        <div class="personality-config">
          <div class="personality-header">
            <span class="personality-icon">üëë</span>
            <div class="personality-info">
              <h4>Beedric Bumbleton</h4>
              <span class="personality-subtitle">Lord of the Royal Hive ‚Ä¢ Hard Difficulty</span>
            </div>
          </div>
          <div class="personality-controls">
            <div class="control-group">
              <label for="beedric-time-limit">Time Limit (seconds):</label>
              <input type="range" id="beedric-time-limit" min="5" max="20" value="10" class="personality-slider">
              <span id="beedric-time-value" class="control-value">10s</span>
            </div>
            <div class="control-group">
              <label for="beedric-depth-limit">Search Depth (ply):</label>
              <input type="range" id="beedric-depth-limit" min="6" max="12" value="8" class="personality-slider">
              <span id="beedric-depth-value" class="control-value">8 ply</span>
            </div>
            <div class="control-group">
              <label for="beedric-aggression">Aggression (1=Defensive, 5=Reckless):</label>
              <input type="range" id="beedric-aggression" min="1" max="5" value="4" class="personality-slider">
              <span id="beedric-aggression-value" class="control-value">4 (Aggressive)</span>
            </div>
            <div class="control-group">
              <label for="beedric-hash">Hash Size (MB):</label>
              <select id="beedric-hash" class="personality-select">
                <option value="16">16 MB</option>
                <option value="32">32 MB</option>
                <option value="64">64 MB</option>
                <option value="128" selected>128 MB</option>
                <option value="256">256 MB</option>
              </select>
            </div>
            <div class="control-group">
              <label for="beedric-mode">Search Mode:</label>
              <select id="beedric-mode" class="personality-select">
                <option value="time" selected>Time-based</option>
                <option value="depth">Depth-based</option>
              </select>
            </div>
            <div class="control-group checkbox-group">
              <input type="checkbox" id="beedric-random-opening">
              <label for="beedric-random-opening">Random Opening Moves</label>
            </div>
          </div>
        </div>
        
        <div class="personality-actions">
          <button id="save-personalities" class="action-btn primary">üíæ Save Settings</button>
          <button id="reset-personalities" class="action-btn secondary">üîÑ Reset to Defaults</button>
          <button id="test-personalities" class="action-btn secondary">üß™ Test Current Settings</button>
        </div>
        
        <div class="personality-tips">
          <h4>üí° Tuning Tips</h4>
          <ul>
            <li><strong>Time-based:</strong> More consistent difficulty scaling, good for casual play</li>
            <li><strong>Depth-based:</strong> More tactical depth, may vary in response time</li>
            <li><strong>Easy (Sunny):</strong> 1-3s or 2-4 ply for beginner-friendly play</li>
            <li><strong>Medium (Buzzwell):</strong> 3-6s or 4-6 ply for balanced challenge</li>
            <li><strong>Hard (Beedric):</strong> 8-15s or 7-10 ply for serious competition</li>
          </ul>
        </div>
      </div>
      
      <!-- Statistics Panel -->
      <div id="statistics-panel" class="dev-ops-panel">
        <h3>Development Statistics</h3>
        <div class="stats-grid">
          <div class="stat-card">
            <h4>AI Battles</h4>
            <div class="stat-value" id="total-battles">0</div>
            <div class="stat-label">Total Battles</div>
          </div>
          <div class="stat-card">
            <h4>Learning Games</h4>
            <div class="stat-value" id="learning-games">0</div>
            <div class="stat-label">Human vs AI</div>
          </div>
          <div class="stat-card">
            <h4>AI Improvement</h4>
            <div class="stat-value" id="ai-improvement">+0%</div>
            <div class="stat-label">Win Rate Change</div>
          </div>
          <div class="stat-card">
            <h4>Best Performer</h4>
            <div class="stat-value" id="best-ai">Beedric</div>
            <div class="stat-label">Current Champion</div>
          </div>
        </div>
        <div class="detailed-stats">
          <h4>Detailed Analysis</h4>
          <div id="stats-details">
            <p>No data available yet. Run some AI battles or learning games to see statistics.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="hex-orient-overlay" aria-hidden="true">
    <!-- SVG will be injected dynamically -->
  </div>
<script>
  const bgVideo = document.getElementById('bg-video');
  bgVideo.playbackRate = 0.4; // 0.5 = half speed, 2 = double speed
</script>

<script>
  // Optional: live tweak with + / - keys
  document.addEventListener('keydown', (e) => {
    if (e.key === '+') bgVideo.playbackRate += 0.1;
    if (e.key === '-') bgVideo.playbackRate = Math.max(0.1, bgVideo.playbackRate - 0.1);
    console.log(`Video speed: ${bgVideo.playbackRate.toFixed(2)}x`);
  });
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.5.10/browser/pixi.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
    <script src="js/board.js"></script>
    <script src="js/game.js?v=1.1"></script>
  <script src="js/pieces.js?v=1.1"></script>
  <script src="js/resize.js"></script>
  <script src="js/main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
  <script src="js/multiplayer.js"></script>
  <!-- Legacy AI systems - commented out for cleaner deployment -->
  <!-- <script src="js/minimax-engine.js"></script> -->
  
  <!-- UHP AI Override MUST load before AI engines -->
  <script src="js/uhp/uhp-ai-override.js"></script>

  <!-- Legacy AI engines - kept commented for debugging if needed -->
  <!-- <script src="js/ai-engine.js"></script> -->
  <!-- <script src="js/ai-engine-v2.js"></script> -->
    </div>

        <!-- Tray Operations Modal -->
        <div id="tray-ops-modal" class="modal">
            <div class="modal-content tray-ops-modal">
                <div class="modal-header">
                    <h3>üì± Tray Operations</h3>
                    <span id="close-tray-ops" class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <!-- Link Trays Option -->
                    <div class="tray-section">
                        <div class="setting-row">
                            <input type="checkbox" id="link-trays-checkbox" />
                            <label for="link-trays-checkbox">üîó Link Trays (Symmetrical Movement)</label>
                        </div>
                    </div>

                    <!-- White Tray Controls -->
                    <div class="tray-section">
                        <h4>‚ö™ White Tray</h4>
                        <div class="setting-row">
                            <label for="white-tray-scale">Scale:</label>
                            <input type="range" id="white-tray-scale" min="50" max="200" value="100" step="5">
                            <span id="white-scale-value">100%</span>
                        </div>
                        <div class="setting-row">
                            <label for="white-tray-x">X Position:</label>
                            <input type="range" id="white-tray-x" min="-500" max="500" value="0" step="10">
                            <span id="white-x-value">0px</span>
                        </div>
                        <div class="setting-row">
                            <label for="white-tray-y">Y Position:</label>
                            <input type="range" id="white-tray-y" min="-300" max="300" value="0" step="10">
                            <span id="white-y-value">0px</span>
                        </div>
                    </div>

                    <!-- Black Tray Controls -->
                    <div class="tray-section">
                        <h4>‚ö´ Black Tray</h4>
                        <div class="setting-row">
                            <label for="black-tray-scale">Scale:</label>
                            <input type="range" id="black-tray-scale" min="50" max="200" value="100" step="5">
                            <span id="black-scale-value">100%</span>
                        </div>
                        <div class="setting-row">
                            <label for="black-tray-x">X Position:</label>
                            <input type="range" id="black-tray-x" min="-500" max="500" value="0" step="10">
                            <span id="black-x-value">0px</span>
                        </div>
                        <div class="setting-row">
                            <label for="black-tray-y">Y Position:</label>
                            <input type="range" id="black-tray-y" min="-300" max="300" value="0" step="10">
                            <span id="black-y-value">0px</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>  <!-- All JS dependencies loaded in order -->
  
  <!-- Duplicate scripts removed - pieces.js and main.js already loaded above -->
  
  <!-- AI opponent personality system -->
  <script src="js/personalities.js"></script>
  
  <!-- NoKamute + Mzinga AI Engine -->
  <script src="js/ai-engine-nokamute-mzinga.js?v=1.2"></script>
  
  <!-- AI user interface components -->
  <script src="js/ai-ui.js"></script>

  <!-- <!-- <script src="js/minimax-engine.js"></script> -->

  <!-- WASM Engine Integration (loads first for offline support) -->
  <script src="js/wasm-engine.js"></script>
  <script src="js/wasm-integration.js"></script>
  <script src="js/personality-ui.js"></script>
  
  <!-- UHP Protocol Client (WASM mode - no WebSocket connection) -->
  <script src="js/uhp/uhp-client.js"></script>
  <script src="js/uhp/engine-integration.js"></script>

  <!-- Scripts consolidated to prevent duplicates -->
  <script src="js/dev-ops.js"></script>
  <script src="js/tray-ops.js"></script>
  
  <!-- Activate Nokamute/Mzinga AI Engine with personality-based difficulty -->
  <script>
    window.addEventListener('load', function() {
      // Start in pure sandbox mode - no AI active by default
      // AI will only activate when explicitly requested via Single Mode or Engine tab
      console.log('üéÆ HYVEMYND loaded in sandbox mode - manual play ready');
    });
  </script>
  
  <!-- Eruda Mobile Console (TEMPORARY - for debugging) -->
  <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
  <script>eruda.init();</script>
</body>
</html>