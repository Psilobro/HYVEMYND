<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Hive â€¢ PIXI Edition</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ</text></svg>">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <video autoplay muted loop playsinline id="bg-video" src="assets/videos/honeycells.mp4"></video>
  <div id="game-title" style="font-family: 'Milonga', serif;">HYVEMYND</div>
  <div id="hud">White to move</div>
  <div id="move-history">
    <ol id="moves-list"></ol>
    <div id="history-controls" style="position:sticky;bottom:0;z-index:10;background:rgba(0,0,0,0.5);padding-top:4px;">
      <input type="range" id="history-slider" min="0" value="0" step="1" style="width: 100%; margin: 8px 0;">
      <button id="return-to-live" style="display:none; margin: 4px 0;">Return to Live</button>
    </div>
  </div>
  <div id="game-container">
    <div id="app"></div>
  </div>
  <div id="white-tray" class="player-tray"></div>
  <div id="black-tray" class="player-tray"></div>
  <button id="play-music-button">Play Music</button>
  <button id="auto-zoom-toggle">Auto-Center: ON</button>
  <button id="move-history-toggle">History</button>
  <button id="single-mode-button">ğŸ¤– Single Mode</button>
  <button id="dev-ops-button">âš™ï¸ Dev. Ops</button>
  <button id="multiplayer-button">ğŸŒ Multiplayer</button>
  <button id="chat-toggle" style="display: none;">ğŸ’¬ Chat</button>
  <audio id="background-music" src="assets/sounds/cosmic-ambient.mp3" loop></audio>
  
  <!-- Chat Container -->
  <div id="chat-container" style="display: none;">
    <div id="chat-header">
      <span>ğŸ’¬ Game Chat</span>
      <button id="chat-close">Ã—</button>
    </div>
    <div id="chat-messages"></div>
    <div id="chat-input-container">
      <input type="text" id="chat-input" placeholder="Type a message..." maxlength="200">
      <button id="chat-send">Send</button>
    </div>
    <div id="typing-indicator"></div>
  </div>

  <!-- Dev. Ops Modal -->
  <div id="dev-ops-modal" style="display: none;">
    <div id="dev-ops-header">
      <span>âš™ï¸ Development Operations</span>
      <button id="dev-ops-close">Ã—</button>
    </div>
    <div id="dev-ops-content">
      <div id="dev-ops-tabs">
        <button class="dev-ops-tab active" data-tab="ai-vs-ai">ğŸ¤– AI vs AI</button>
        <button class="dev-ops-tab" data-tab="human-learning">ğŸ§  Human Learning</button>
        <button class="dev-ops-tab" data-tab="engine">ğŸ”§ Engine</button>
        <button class="dev-ops-tab" data-tab="statistics">ğŸ“Š Statistics</button>
      </div>
      
      <!-- AI vs AI Panel -->
      <div id="ai-vs-ai-panel" class="dev-ops-panel active">
        <h3>AI Battle Arena</h3>
        <div class="ai-battle-setup">
          <div class="player-selection">
            <label>White AI:</label>
            <select id="white-ai-select">
              <option value="sunny">Sunny (Depth 3)</option>
              <option value="buzzwell">Buzzwell (Depth 4)</option>
              <option value="beedric">Beedric (Depth 6)</option>
            </select>
          </div>
          <div class="player-selection">
            <label>Black AI:</label>
            <select id="black-ai-select">
              <option value="buzzwell" selected>Buzzwell (Depth 4)</option>
              <option value="sunny">Sunny (Depth 3)</option>
              <option value="beedric">Beedric (Depth 6)</option>
            </select>
          </div>
          <div class="battle-controls">
            <button id="start-ai-battle">ğŸš€ Start Battle</button>
            <button id="stop-ai-battle" style="display: none;">â¹ï¸ Stop Battle</button>
            <div class="battle-speed">
              <label>Speed:</label>
              <input type="range" id="battle-speed" min="100" max="3000" value="1000" step="100">
              <span id="speed-display">1.0s</span>
            </div>
          </div>
        </div>
        <div id="battle-status" class="battle-status">Ready to start AI battle</div>
      </div>
      
      <!-- Human Learning Panel -->
      <div id="human-learning-panel" class="dev-ops-panel">
        <h3>Human Learning Mode</h3>
        <div class="learning-setup">
          <p>Train AI by playing against it. Your moves and strategies will be analyzed to improve AI performance.</p>
          <div class="learning-controls">
            <button id="start-learning-game">ğŸ“ Start Learning Game</button>
            <div class="learning-opponent">
              <label>Opponent:</label>
              <select id="learning-opponent-select">
                <option value="beedric" selected>Beedric V2 (Learning)</option>
              </select>
            </div>
          </div>
        </div>
        <div id="learning-status" class="learning-status">Ready to start learning session</div>
      </div>
      
      <!-- Engine Panel -->
      <div id="engine-panel" class="dev-ops-panel">
        <h3>ğŸ”§ Engine Controller</h3>
        
        <div class="engine-status-section">
          <div class="engine-status-header">
            <h4>Connection Status</h4>
            <div id="engine-connection-status" class="connection-status">
              <span id="connection-indicator" class="status-dot disconnected"></span>
              <span id="connection-text">Connecting to UHP Bridge...</span>
            </div>
          </div>
          
          <div id="engine-thinking-indicator" class="thinking-indicator" style="display: none;">
            <span class="thinking-dots">ğŸ§  Engine thinking</span>
          </div>
        </div>

        <div class="engine-controls-section">
          <h4>Engine Selection</h4>
          <div class="engine-selection">
            <div class="control-group">
              <label for="engine-select">Active Engine:</label>
              <select id="engine-select">
                <option value="nokamute">Nokamute (Tournament)</option>
                <option value="mzinga">Mzinga Engine</option>
                <option value="custom">Custom Engine</option>
              </select>
              <button id="restart-engine" class="engine-action">ğŸ”„ Restart</button>
            </div>
            
            <div id="custom-engine-config" class="control-group" style="display: none;">
              <label for="custom-engine-path">Custom Engine Path:</label>
              <input type="text" id="custom-engine-path" placeholder="C:\path\to\your\engine.exe">
              <button id="add-custom-engine" class="engine-action">â• Add Engine</button>
            </div>
          </div>
        </div>

        <div class="engine-settings-section">
          <h4>Engine Parameters</h4>
          <div class="settings-grid">
            <div class="control-group">
              <label>
                <input type="checkbox" id="engine-enabled"> Enable UHP Engine
              </label>
              <small>Use external engine for AI moves</small>
            </div>
            
            <div class="control-group">
              <label for="engine-mode">Mode:</label>
              <select id="engine-mode">
                <option value="time">Time Limited</option>
                <option value="depth">Depth Limited</option>
              </select>
            </div>
            
            <div class="control-group">
              <label for="time-limit">Time Limit:</label>
              <div class="slider-container">
                <input type="range" id="time-limit" min="1" max="30" value="5" step="1">
                <span id="time-value">5s</span>
              </div>
            </div>
            
            <div class="control-group">
              <label for="depth-limit">Search Depth:</label>
              <div class="slider-container">
                <input type="range" id="depth-limit" min="1" max="10" value="4" step="1">
                <span id="depth-value">4 ply</span>
              </div>
            </div>
            
            <div class="control-group">
              <label for="engine-color">Engine Plays:</label>
              <select id="engine-color">
                <option value="black">Black (Default AI)</option>
                <option value="white">White (Human opponent)</option>
                <option value="both">Both (Engine vs Engine)</option>
              </select>
            </div>
          </div>
        </div>

        <div class="engine-log-section">
          <h4>Engine Communication</h4>
          <div id="engine-log" class="engine-log">
            <div class="log-entry">ğŸ”— Starting UHP client...</div>
          </div>
          <div class="log-controls">
            <button id="clear-log" class="engine-action">ğŸ—‘ï¸ Clear Log</button>
            <button id="test-engine" class="engine-action">ğŸ§ª Test Engine</button>
          </div>
        </div>

        <div class="engine-info-section">
          <h4>About UHP</h4>
          <p>Universal Hive Protocol (UHP) allows HYVEMYND to connect with tournament-strength engines like Nokamute and Mzinga.</p>
          <div class="engine-commands">
            <strong>Quick Start:</strong>
            <ol>
              <li>Start UHP Bridge: <code>node tools/uhp-bridge.js</code></li>
              <li>Enable UHP Engine above</li>
              <li>Start a game - engine will play automatically!</li>
            </ol>
          </div>
        </div>
      </div>
      
      <!-- Statistics Panel -->
      <div id="statistics-panel" class="dev-ops-panel">
        <h3>Development Statistics</h3>
        <div class="stats-grid">
          <div class="stat-card">
            <h4>AI Battles</h4>
            <div class="stat-value" id="total-battles">0</div>
            <div class="stat-label">Total Battles</div>
          </div>
          <div class="stat-card">
            <h4>Learning Games</h4>
            <div class="stat-value" id="learning-games">0</div>
            <div class="stat-label">Human vs AI</div>
          </div>
          <div class="stat-card">
            <h4>AI Improvement</h4>
            <div class="stat-value" id="ai-improvement">+0%</div>
            <div class="stat-label">Win Rate Change</div>
          </div>
          <div class="stat-card">
            <h4>Best Performer</h4>
            <div class="stat-value" id="best-ai">Beedric</div>
            <div class="stat-label">Current Champion</div>
          </div>
        </div>
        <div class="detailed-stats">
          <h4>Detailed Analysis</h4>
          <div id="stats-details">
            <p>No data available yet. Run some AI battles or learning games to see statistics.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="hex-orient-overlay" aria-hidden="true">
    <!-- SVG will be injected dynamically -->
  </div>
<script>
  const bgVideo = document.getElementById('bg-video');
  bgVideo.playbackRate = 0.4; // 0.5 = half speed, 2 = double speed
</script>

<script>
  // Optional: live tweak with + / - keys
  document.addEventListener('keydown', (e) => {
    if (e.key === '+') bgVideo.playbackRate += 0.1;
    if (e.key === '-') bgVideo.playbackRate = Math.max(0.1, bgVideo.playbackRate - 0.1);
    console.log(`Video speed: ${bgVideo.playbackRate.toFixed(2)}x`);
  });
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.5.10/browser/pixi.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
    <script src="js/board.js"></script>
    <script src="js/game.js?v=1.1"></script>
  <script src="js/pieces.js?v=1.1"></script>
  <script src="js/resize.js"></script>
  <script src="js/main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
  <script src="js/multiplayer.js"></script>
  <script src="js/minimax-engine.js"></script>
  
  <!-- UHP AI Override MUST load before AI engines -->
  <script src="js/uhp/uhp-ai-override.js"></script>
  
  <script src="js/ai-engine.js"></script>
  <script src="js/ai-engine-v2.js"></script>
  <script src="js/ai-engine-nokamute-mzinga.js?v=1.2"></script>
  <script src="js/personalities.js"></script>
  <script src="js/ai-ui.js"></script>
  <script src="js/dev-ops.js"></script>
  
  <!-- UHP Engine Integration -->
  <script src="js/uhp/uhp-client.js"></script>
  <script src="js/uhp/engine-integration.js"></script>
  
  <!-- Activate Nokamute/Mzinga AI Engine with personality-based difficulty -->
  <script>
    window.addEventListener('load', function() {
      // Small delay to ensure all scripts are loaded
      setTimeout(function() {
        if (typeof window.activateNokamuteMzingaAI === 'function') {
          // Default activation - AI-UI will override with proper difficulty
          window.activateNokamuteMzingaAI('medium');
          console.log('ğŸš€ Nokamute/Mzinga AI Engine activated by default!');
        } else {
          console.error('âŒ activateNokamuteMzingaAI function not found');
        }
      }, 100);
    });
  </script>
</body>
</html>